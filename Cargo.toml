[workspace]
members = [
    ".",
    "crates/core-manifest",
    "crates/core-starmap",
    "crates/core-audit",
]

[package]
name = "orbit"
version = "0.4.0"
edition = "2021"
authors = ["Shane Wall <shaneawall@gmail.com>"]
description = "Intelligent file transfer with checksum, compression, resume capability, and protocol abstraction"
license-file = "LICENSE"
readme = "README.md"
repository = "https://github.com/saworbit/orbit"
keywords = ["file-copy", "resume", "compression", "checksum", "backup"]

[dependencies]
# Core dependencies
clap = { version = "4.5", features = ["derive", "cargo"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
toml = "0.8"

# File I/O and progress
indicatif = "0.17"
walkdir = "2.5"

# Compression
lz4 = "1.25"
zstd = "0.13"

# Checksums
sha2 = "0.10"
blake3 = "1.5"

# Parallel processing
rayon = "1.10"
crossbeam-channel = "0.5"

# System information
sysinfo = "0.35"

# Pattern matching
glob = "0.3"

# Date/time
chrono = { version = "0.4", features = ["serde"] }

# Error handling
thiserror = "1.0"
anyhow = "1.0"

# File metadata utilities
filetime = "0.2"
clap_complete = "4.5"

# Encoding
hex = "0.4"

# Manifest system
orbit-core-manifest = { path = "crates/core-manifest" }
orbit-core-starmap = { path = "crates/core-starmap" }
orbit-core-audit = { path = "crates/core-audit" }

# Zero-copy support (Linux)
[target.'cfg(target_os = "linux")'.dependencies]
rustix = { version = "0.38", features = ["fs"] }
libc = "0.2"

# Zero-copy support (macOS/BSD)
[target.'cfg(target_os = "macos")'.dependencies]
libc = "0.2"

# Zero-copy support (Windows) - uses std library, no extra deps needed

[dev-dependencies]
tempfile = "3.10"
criterion = "0.5"
assert_fs = "1.1"
predicates = "3.1"

[lib]
name = "orbit"
path = "src/lib.rs"

[[bin]]
name = "orbit"
path = "src/main.rs"

[[bench]]
name = "copy_benchmark"
harness = false

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
strip = true

[profile.bench]
inherits = "release"

[features]
default = ["zero-copy"]

# Zero-copy system calls for maximum performance
zero-copy = []

# Protocol support (experimental)
protocols = []

# Full feature set
full = ["zero-copy", "protocols"]
